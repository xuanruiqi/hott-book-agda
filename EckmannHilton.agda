{-# OPTIONS --without-K --exact-split --safe #-}

module EckmannHilton where
  open import HUniverse
  open import Path
  
  Î©[_,_] : (A : Type â„“) â†’ (a : A) â†’ Type â„“
  Î©[ A , a ] = a â‰¡ a
  
  Î©Â²[_,_] : (A : Type â„“) â†’ (a : A) â†’ Type â„“
  Î©Â²[ A , a ] = Î©[ (Î©[ A , a ]) , refl ]

  _Â·áµ£_ : âˆ€ {a b c : A} {p q : a â‰¡ b} â†’ (Î± : p â‰¡ q) â†’ (r : b â‰¡ c) â†’ p Â· r â‰¡ q Â· r
  Î± Â·áµ£ refl = ((ğŸ™áµ£ â»Â¹) Â· Î±) Â· ğŸ™áµ£

  _Â·â‚—_ : âˆ€ {a b c : A} {r s : b â‰¡ c} â†’ (q : a â‰¡ b) â†’ (Î² : r â‰¡ s) â†’ q Â· r â‰¡ q Â· s
  refl Â·â‚— Î² = ((ğŸ™â‚— â»Â¹) Â· Î²) Â· ğŸ™â‚—

  hor-comp : âˆ€ {a b c : A} {p q : a â‰¡ b} {r s : b â‰¡ c} â†’ (Î± : p â‰¡ q) â†’ (Î² : r â‰¡ s) â†’ p Â· r â‰¡ q Â· s
  hor-comp {q = q} {r = r} Î± Î² = (Î± Â·áµ£ r) Â· (q Â·â‚— Î²)

  _â˜…_ : âˆ€ {a b c : A} {p q : a â‰¡ b} {r s : b â‰¡ c} â†’ (Î± : p â‰¡ q) â†’ (Î² : r â‰¡ s) â†’ p Â· r â‰¡ q Â· s
  Î± â˜… Î² = hor-comp Î± Î²

  hor-comp' : âˆ€ {a b c : A} {p q : a â‰¡ b} {r s : b â‰¡ c} â†’ (Î± : p â‰¡ q) â†’ (Î² : r â‰¡ s) â†’ p Â· r â‰¡ q Â· s
  hor-comp' {p = p} {s = s} Î± Î² = (p Â·â‚— Î²) Â· (Î± Â·áµ£ s)

  _â˜…'_ : âˆ€ {a b c : A} {p q : a â‰¡ b} {r s : b â‰¡ c} â†’ (Î± : p â‰¡ q) â†’ (Î² : r â‰¡ s) â†’ p Â· r â‰¡ q Â· s
  Î± â˜…' Î² = hor-comp' Î± Î²

  â˜…-â˜…'-equiv : âˆ€ {a : A} {p : a â‰¡ a} {r : a â‰¡ a} â†’ (Î± : p â‰¡ refl) â†’ (Î² : r â‰¡ refl) â†’ Î± â˜… Î² â‰¡ Î± â˜…' Î²
  â˜…-â˜…'-equiv refl refl = refl

  â˜…-Â·-equiv : âˆ€ {a : A} (Î± Î² : Î©Â²[ A , a ]) â†’ Î± â˜… Î² â‰¡ Î± Â· Î²
  â˜…-Â·-equiv Î± Î² =
    begin
      Î± â˜… Î²
    â‰¡âŸ¨ refl âŸ©
      (((ğŸ™áµ£ â»Â¹) Â· Î±) Â· ğŸ™áµ£) Â· (((ğŸ™â‚— â»Â¹) Â· Î²) Â· ğŸ™â‚—)
    â‰¡âŸ¨ refl âŸ©
      (((refl â»Â¹) Â· Î±) Â· refl) Â· (((refl â»Â¹) Â· Î²) Â· refl)  
    â‰¡âŸ¨ refl âŸ©
      ((refl Â· Î±) Â· refl) Â· ((refl Â· Î²) Â· refl)
    â‰¡âŸ¨ cong (Î» m â†’ (m Â· _) Â· _) (ğŸ™â‚— â»Â¹) âŸ©
      (Î± Â· refl) Â· ((refl Â· Î²) Â· refl)
    â‰¡âŸ¨ cong (Î» m â†’ _ Â· (m Â· _)) (ğŸ™â‚— â»Â¹) âŸ©
      (Î± Â· refl) Â· (Î² Â· refl)
    â‰¡âŸ¨ cong (Î» m â†’ m Â· _) (ğŸ™áµ£ â»Â¹) âŸ©
      Î± Â· (Î² Â· refl)
    â‰¡âŸ¨ cong (Î» m â†’ _ Â· m) (ğŸ™áµ£ â»Â¹) âŸ©
      Î± Â· Î²
    âˆ

  â˜…'-Â·-equiv : âˆ€ {a : A} (Î± Î² : Î©Â²[ A , a ]) â†’ Î± â˜…' Î² â‰¡ Î² Â· Î±
  â˜…'-Â·-equiv Î± Î² =
    begin
      Î± â˜…' Î²
    â‰¡âŸ¨ refl âŸ©
      (((ğŸ™â‚— â»Â¹) Â· Î²) Â· ğŸ™â‚—) Â· (((ğŸ™áµ£ â»Â¹) Â· Î±) Â· ğŸ™áµ£)
    â‰¡âŸ¨ refl âŸ©
      (((refl â»Â¹) Â· Î²) Â· refl) Â· (((refl â»Â¹) Â· Î±) Â· refl)
    â‰¡âŸ¨ refl âŸ©
      ((refl Â· Î²) Â· refl) Â· ((refl Â· Î±) Â· refl)
    â‰¡âŸ¨ cong (Î» m â†’ (m Â· _) Â· _) (ğŸ™â‚— â»Â¹) âŸ©
      (Î² Â· refl) Â· ((refl Â· Î±) Â· refl)
    â‰¡âŸ¨ cong (Î» m â†’ _ Â· (m Â· _))(ğŸ™â‚— â»Â¹) âŸ©
      (Î² Â· refl) Â· (Î± Â· refl)
    â‰¡âŸ¨ cong (Î» m â†’ m Â· _) (ğŸ™áµ£ â»Â¹) âŸ©
      Î² Â· (Î± Â· refl)
    â‰¡âŸ¨ cong (Î» m â†’ _ Â· m) (ğŸ™áµ£ â»Â¹) âŸ©
      Î² Â· Î±
    âˆ

  eckmann-hilton : âˆ€ {a : A} (Î± Î² : Î©Â²[ A , a ]) â†’ Î± Â· Î² â‰¡ Î² Â· Î±
  eckmann-hilton Î± Î² =
    begin
      Î± Â· Î²
    â‰¡âŸ¨ (â˜…-Â·-equiv Î± Î²) â»Â¹ âŸ©
      Î± â˜… Î²
    â‰¡âŸ¨ â˜…-â˜…'-equiv Î± Î² âŸ©
      Î± â˜…' Î²
    â‰¡âŸ¨ â˜…'-Â·-equiv Î± Î² âŸ©
      Î² Â· Î±
    âˆ
